<div class="section-{{ section.id }}-padding">
  <div class="page-width container">
    <div class="product__wrapper width-base">
      {%- assign first_available_variant = product.selected_or_first_available_variant -%}

      <div class="product__media">
        <div class="product-media-gallery">
          <div class="media-gallery-container">
            <!-- Thumbnail Swiper - Left Side -->
            {% if product.media.size > 1 %}
              <div class="thumbnail-column">
                <div class="swiper thumb-product-swiper vertical">
                  <div class="swiper-wrapper">
                    {% for media in product.media %}
                      <div class="swiper-slide">
                        {% if media.media_type == 'image' %}
                          <img
                            src="{{ media | image_url: width: 100 }}"
                            alt="{{ media.alt | escape }}"
                            loading="lazy"
                          >
                        {% endif %}
                      </div>
                    {% endfor %}
                  </div>
                </div>
              </div>
            {% endif %}

            <!-- Main Product Image Swiper - Right Side -->
            <div class="main-image-column">
              <div class="swiper main-product-swiper">
                <div class="swiper-wrapper">
                  {% for media in product.media %}
                    <div class="swiper-slide">
                      {% render 'product-media', media: media %}
                    </div>
                  {% endfor %}
                </div>

                <!-- Navigation -->
                <div class="swiper-button-next"></div>
                <div class="swiper-button-prev"></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="product__details">
        <div>
          {% for block in section.blocks %}
            {% case block.type %}
              {% when 'title' %}
                <h1 class="product__title h1">{{ product.title }}</h1>
              {% when 'price' %}
                <div class="product__rating-price">
                  <!-- Rating Stars -->
                  <div class="product__rating">
                    <div class="rating-stars">
                      <span class="star filled">★</span>
                      <span class="star filled">★</span>
                      <span class="star filled">★</span>
                      <span class="star filled">★</span>
                      <span class="star half">★</span>
                    </div>
                    <span class="rating-count">(1,873)</span>
                  </div>
                  <div class="product__meta">
                    <div class="product__tags">
                      {% if product.tags.size > 0 %}
                        {% for tag in product.tags limit: 5 %}
                          <span class="tag product__benefit-label">{{ tag }}</span>
                        {% endfor %}
                      {% elsif product.metafields.custom.benefits %}
                        {% assign benefits = product.metafields.custom.benefits | split: ',' %}
                        {% for benefit in benefits limit: 5 %}
                          <span class="tag">{{ benefit | strip }}</span>
                        {% endfor %}
                      {% else %}
                        <span class="tag"></span>
                      {% endif %}
                    </div>

                    <p class="product__short-description">
                      {% if product.metafields.custom.short_description %}
                        {{ product.metafields.custom.short_description }}
                      {% elsif product.description %}
                        {{ product.description | strip_html | truncate: 120 }}
                      {% else %}
                        Discover the benefits of this premium product designed for your needs.
                      {% endif %}
                    </p>
                  </div>
                </div>

              {% when 'variant_picker' %}
                {% unless product.has_only_default_variant %}
                  <div class="product__variants">
                    <div class="variant-options">
                      {% for option in product.options_with_values %}
                        <div class="variant-option">
                          {% comment %} <h4 class="variant-title">{{ option.name }}</h4> {% endcomment %}
                          <div class="variant-buttons">
                            {% for value in option.values %}
                              <button
                                type="button"
                                class="variant-btn {% if forloop.first %}active{% endif %}"
                                data-value="{{ value }}"
                              >
                                {{ value }}
                              </button>
                            {% endfor %}
                          </div>
                        </div>
                      {% endfor %}
                    </div>
                  </div>
                {% endunless %}

              {% when 'buy_buttons' %}
                <div class="product__purchase-options">
                  <!-- Purchase Type -->
                  <div class="purchase-type">
                    <div class="purchase-option">
                      <input type="radio" id="one-time" name="purchase-type" value="one-time">
                      <label for="one-time" class="purchase-label">
                        <span class="option-text">One-time Purchase</span>
                        <span class="option-price">{{ product.price | money }}</span>
                      </label>
                    </div>

                    <div class="purchase-option active">
                      <input type="radio" id="subscribe" name="purchase-type" value="subscribe" checked>
                      <label for="subscribe" class="purchase-label">
                        <span class="option-text">Subscribe & Save</span>
                        <span class="option-price">{{ product.price | times: 0.85 | money }}</span>
                        <span class="save-badge">SAVE 15%</span>
                      </label>
                      <div class="subscription-benefits">
                        <p>✓ Save 15%</p>
                        <p>✓ No commitment, cancel anytime</p>
                      </div>
                    </div>
                  </div>

                  <!-- Delivery Schedule -->
                  <div class="delivery-schedule">
                    <div class="schedule-options">
                      <button type="button" class="schedule-btn active">30 Days</button>
                      <button type="button" class="schedule-btn">60 Days</button>
                      <button type="button" class="schedule-btn">90 Days</button>
                    </div>
                  </div>

                  <!-- Quantity & Add to Cart -->
                  <div class="quantity-cart-section">
                    {% form 'product', product, class: 'product-form flex-1' %}
                      <button
                        type="submit"
                        class="add-to-cart-btn"
                        {% if first_available_variant.available == false %}
                          disabled
                        {% endif %}
                      >
                        ADD TO BAG
                      </button>
                    {% endform %}
                  </div>
                </div>
              {% when 'description' %}
                <div class="product__description rte">
                  {{ product.description }}
                </div>
            {% endcase %}
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
  <!-- Start of Judge.me code -->
  <div style="clear:both"></div>
  <div
    id="judgeme_product_reviews"
    class="jdgm-widget jdgm-review-widget"
    data-product-title="{{ product.title | escape }}"
    data-id="{{ product.id }}"
    data-auto-install="false"
  >
    {{ product.metafields.judgeme.widget }}
  </div>
  <!-- End of Judge.me code -->
</div>

{% schema %}
{
  "name": "Product",
  "tag": "section",
  "blocks": [
    {
      "type": "vendor",
      "name": "Vendor",
      "limit": 1
    },
    {
      "type": "title",
      "name": "Title",
      "limit": 1
    },
    {
      "type": "price",
      "name": "Price",
      "limit": 1
    },
    {
      "type": "variant_picker",
      "name": "Variant picker",
      "limit": 1
    },
    {
      "type": "quantity",
      "name": "Quantity",
      "limit": 1
    },
    {
      "type": "buy_buttons",
      "name": "Buy buttons",
      "limit": 1
    },
    {
      "type": "description",
      "name": "Description",
      "limit": 1
    }
  ],
  "settings": [
    {
      "type": "checkbox",
      "id": "enable_sticky_info",
      "default": true,
      "label": "Enable sticky info"
    },
    {
      "type": "select",
      "id": "gallery_layout",
      "options": [
        {
          "value": "stacked",
          "label": "Stacked"
        },
        {
          "value": "thumbnail",
          "label": "Thumbnail"
        }
      ],
      "default": "stacked",
      "label": "Gallery layout"
    }
  ]
}
{% endschema %}
